<mxfile host="app.diagrams.net" modified="2020-08-31T06:02:28.702Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36" etag="U6FoKEnAUyMahjCSeAxE" version="13.6.5" type="github">
  <diagram id="6I0OCvxSQrVGMHxT2VVA" name="Page-1">
    <mxGraphModel dx="1673" dy="896" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="dKdSaXE48SgPbhcamS2K-63" value="POW+POM" style="text;strokeColor=none;fillColor=none;html=1;fontSize=24;fontStyle=1;verticalAlign=middle;align=center;" parent="1" vertex="1">
          <mxGeometry x="150" y="60" width="530" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-24" value="&lt;span style=&quot;box-sizing: border-box ; outline: 0px ; margin: 0px ; padding: 0px ; font-weight: 700 ; overflow-wrap: break-word ; color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;em style=&quot;box-sizing: border-box ; outline: 0px ; margin: 0px ; padding: 0px ; overflow-wrap: break-word&quot;&gt;RAND(h, n)&amp;nbsp; &amp;lt;=&amp;nbsp; M / d&lt;/em&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="217.5" y="150" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-25" value="&lt;span style=&quot;color: rgb(77, 77, 77); font-family: &amp;quot;microsoft yahei&amp;quot;, &amp;quot;sf pro display&amp;quot;, roboto, noto, arial, &amp;quot;pingfang sc&amp;quot;, sans-serif; font-size: 18px; font-style: normal; font-weight: 400; letter-spacing: normal; text-align: -webkit-left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline; float: none;&quot;&gt;M表示一个极大的数，比如2^256-1；&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="230" width="330" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-26" value="&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; font-style: normal ; letter-spacing: normal ; text-align: -webkit-left ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(255 , 255 , 255) ; display: inline ; float: none&quot;&gt;&lt;b&gt;把POM算法和POW融合，首先要了解POW过程原理&lt;/b&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="440" width="460" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-27" value="&lt;span style=&quot;color: rgb(77, 77, 77); font-family: &amp;quot;microsoft yahei&amp;quot;, &amp;quot;sf pro display&amp;quot;, roboto, noto, arial, &amp;quot;pingfang sc&amp;quot;, sans-serif; font-size: 18px; font-style: normal; font-weight: 400; letter-spacing: normal; text-align: -webkit-left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline; float: none;&quot;&gt;RAND()是一个概念函数，它代表了一系列复杂的运算，并最终产生一个类似随机的数&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="260" width="750" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-28" value="&lt;span style=&quot;color: rgb(77, 77, 77); font-family: &amp;quot;microsoft yahei&amp;quot;, &amp;quot;sf pro display&amp;quot;, roboto, noto, arial, &amp;quot;pingfang sc&amp;quot;, sans-serif; font-size: 18px; font-style: normal; font-weight: 400; letter-spacing: normal; text-align: -webkit-left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline; float: none;&quot;&gt;h是Header的哈希值(Header.HashNoNonce())&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="290" width="410" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-29" value="&lt;span style=&quot;color: rgb(77, 77, 77); font-family: &amp;quot;microsoft yahei&amp;quot;, &amp;quot;sf pro display&amp;quot;, roboto, noto, arial, &amp;quot;pingfang sc&amp;quot;, sans-serif; font-size: 18px; font-style: normal; font-weight: 400; letter-spacing: normal; text-align: -webkit-left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline; float: none;&quot;&gt;n表示Header成员Nonce&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="320" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-30" value="&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; font-style: normal ; letter-spacing: normal ; text-align: -webkit-left ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(255 , 255 , 255) ; display: inline ; float: none&quot;&gt;&lt;b&gt;在最大不超过M的范围内，以某个方式找到一个数，这个数符合条件(&amp;lt;=M/d)，就认为Seal()成功&lt;/b&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="350" width="810" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Ssi0FaVRhQvzBARQemNV-31" value="&lt;span style=&quot;color: rgb(77, 77, 77); font-family: &amp;quot;microsoft yahei&amp;quot;, &amp;quot;sf pro display&amp;quot;, roboto, noto, arial, &amp;quot;pingfang sc&amp;quot;, sans-serif; font-size: 18px; font-style: normal; font-weight: 400; letter-spacing: normal; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline; float: none;&quot;&gt;Ethash算法&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="30" y="100" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="naCmm93XrFvzdD8Qjq0J-3" target="naCmm93XrFvzdD8Qjq0J-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="294.03999999999996" y="1205.98" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-3" value="&lt;font style=&quot;font-size: 17px&quot;&gt;New():Miner&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="110" y="775" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-8" value="&lt;font style=&quot;font-size: 17px&quot;&gt;newWorker()&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="295" y="855" width="165" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-9" value="&lt;font style=&quot;font-size: 17px&quot;&gt;regester Agent to worker&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="295" y="1045" width="165" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-14" value="" style="endArrow=classic;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="naCmm93XrFvzdD8Qjq0J-9">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="170" y="1065" as="sourcePoint" />
            <mxPoint x="240" y="1025" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-15" value="" style="endArrow=classic;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="170" y="874.5" as="sourcePoint" />
            <mxPoint x="295" y="874.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-16" value="&lt;font style=&quot;font-size: 17px&quot;&gt;go&lt;br&gt;miner.Update()&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="295" y="1095" width="165" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-17" value="&lt;h2 style=&quot;box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-weight: 700; font-family: &amp;quot;microsoft yahei&amp;quot;, &amp;quot;sf pro display&amp;quot;, roboto, noto, arial, &amp;quot;pingfang sc&amp;quot;, sans-serif; font-size: 24px; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word; font-style: normal; letter-spacing: normal; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);&quot;&gt;新区块的组装流程&lt;/h2&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="25" y="710" width="220" height="70" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-18" value="&lt;font style=&quot;font-size: 17px&quot;&gt;go&lt;br&gt;worker.update()&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="885" width="165" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-19" value="&lt;font style=&quot;font-size: 17px&quot;&gt;go&lt;br&gt;worker.wait()&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="945" width="165" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-20" value="&lt;font style=&quot;font-size: 17px&quot;&gt;worker.&lt;br&gt;CommitNewWork()&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="480" y="1005" width="165" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="naCmm93XrFvzdD8Qjq0J-8" target="naCmm93XrFvzdD8Qjq0J-20">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="305" y="1215" as="targetPoint" />
            <mxPoint x="180" y="845" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-22" value="" style="endArrow=classic;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="naCmm93XrFvzdD8Qjq0J-19">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="965" as="sourcePoint" />
            <mxPoint x="480" y="964.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-23" value="" style="endArrow=classic;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="905" as="sourcePoint" />
            <mxPoint x="480" y="904.6599999999999" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-24" value="&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(255 , 255 , 255) ; display: inline ; float: none&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 主要的数据传输发生在worker和它的Agent(们)之间：在合适的时候，worker把一个Work对象发送给每个Agent，然后任何一个Agent完成mine时，将一个经过授权确认的Block加上那个更新过的Work，组成一个Result对象发送回worker。&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="470" width="820" height="80" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-26" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="naCmm93XrFvzdD8Qjq0J-25">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="356.66666666666674" y="540" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-25" value="&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(255 , 255 , 255) ; display: inline ; float: none&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 对于一个新区块被挖掘出的过程，代码实现上基本分为两个环节：&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="540" width="600" height="40" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-27" value="&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(255 , 255 , 255) ; display: inline ; float: none&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 一是组装出一个新区块，这个区块的数据基本完整，包括成员Header的部分属性，以及交易列表txs，和叔区块组uncles[]，并且所有交易已经执行完毕，所有收据(Receipt)也已收集完毕，这部分主要由worker完成；&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="570" width="810" height="80" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-28" value="&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(255 , 255 , 255) ; display: inline ; float: none&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(77 , 77 , 77) ; font-family: &amp;#34;microsoft yahei&amp;#34; , &amp;#34;sf pro display&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto&amp;#34; , &amp;#34;arial&amp;#34; , &amp;#34;pingfang sc&amp;#34; , sans-serif ; font-size: 18px ; background-color: rgb(255 , 255 , 255)&quot;&gt;二是填补该区块剩余的成员属性，比如Header.Difficulty等，并完成授权，这些工作是由Agent调用&amp;lt;Engine&amp;gt;接口实现体，利用共识算法来完成的。&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="640" width="810" height="60" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-29" value="&lt;b&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;DTT挖矿难度计算&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="25" y="1180" width="225" height="30" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-31" value="&lt;p class=&quot;MsoNormal&quot; style=&quot;text-indent: 21pt ; font-size: 18px&quot;&gt;&lt;span&gt;&amp;nbsp; 以太坊每次挖矿均需计算当前区块难度。&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　按版本不同有三种计算难度的规则，分别为：&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;calcDifficultyByzantium&lt;/span&gt;&lt;span&gt;（&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;Byzantium&lt;/span&gt;&lt;span&gt;版）、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;calcDifficultyHomestead&lt;/span&gt;&lt;span&gt;（&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;Homestead&lt;/span&gt;&lt;span&gt;版）、&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;calcDifficultyFrontier&lt;/span&gt;&lt;span&gt;（&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;Frontier&lt;/span&gt;&lt;span&gt;版）。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;MsoNormal&quot; style=&quot;text-indent: 21pt ; font-size: 18px&quot;&gt;&lt;span&gt;&amp;nbsp; 此处以&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;calcDifficultyHomestead&lt;/span&gt;&lt;span&gt;为例。&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="25" y="1210" width="775" height="140" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-32" value="&lt;p class=&quot;MsoNormal&quot; style=&quot;text-indent: 21.0pt&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;计算难度时输入有：&lt;/font&gt;&lt;/span&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="25" y="1330" width="215" height="50" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-33" value="&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;table class=&quot;MsoTableGrid&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; style=&quot;border-collapse: collapse ; border: none ; font-size: 18px&quot;&gt; &lt;tbody&gt;&lt;tr&gt;  &lt;td width=&quot;104&quot; valign=&quot;top&quot; style=&quot;width: 77.75pt ; border: solid 1.0pt ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;parent_timestamp&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt;  &lt;td width=&quot;449&quot; valign=&quot;top&quot; style=&quot;width: 337.05pt ; border: solid 1.0pt ; border-left: none ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;父区块时间戳&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt;  &lt;td width=&quot;104&quot; valign=&quot;top&quot; style=&quot;width: 77.75pt ; border: solid 1.0pt ; border-top: none ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;parent_diff&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt;  &lt;td width=&quot;449&quot; valign=&quot;top&quot; style=&quot;width: 337.05pt ; border-top: none ; border-left: none ; border-bottom: solid 1.0pt ; border-right: solid 1.0pt ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;父区块难度&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt;  &lt;td width=&quot;104&quot; valign=&quot;top&quot; style=&quot;width: 77.75pt ; border: solid 1.0pt ; border-top: none ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;block_timestamp&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt;  &lt;td width=&quot;449&quot; valign=&quot;top&quot; style=&quot;width: 337.05pt ; border-top: none ; border-left: none ; border-bottom: solid 1.0pt ; border-right: solid 1.0pt ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;当前区块时间戳&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt;  &lt;td width=&quot;104&quot; valign=&quot;top&quot; style=&quot;width: 77.75pt ; border: solid 1.0pt ; border-top: none ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span lang=&quot;EN-US&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;block_number&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt;  &lt;td width=&quot;449&quot; valign=&quot;top&quot; style=&quot;width: 337.05pt ; border-top: none ; border-left: none ; border-bottom: solid 1.0pt ; border-right: solid 1.0pt ; padding: 0cm 5.4pt 0cm 5.4pt&quot;&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;当前区块的序号&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;br&gt;  &lt;/font&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="1020" width="550" height="795" as="geometry" />
        </mxCell>
        <mxCell id="naCmm93XrFvzdD8Qjq0J-34" value="&lt;font style=&quot;font-size: 22px&quot;&gt;block_diff = parent_diff + &lt;br&gt;&lt;br&gt;(parent_diff / 2048 * max(1 - (block_timestamp - parent_timestamp) // 10, -99)&lt;br&gt;&lt;br&gt;+ 2^((block_number // 100000) - 2)&lt;/font&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="30" y="1815" width="780" height="125" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
